<!DOCTYPE html>

<html lang="en" data-content_root="../../../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>chipsec.modules.tools.vmm.hv.define &#8212; CHIPSEC  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/classic.css?v=f40a2feb" />
    
    <script src="../../../../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../../../../../../_static/chipsec_favicon.jpg"/>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../../index.html">CHIPSEC  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">chipsec.modules.tools.vmm.hv.define</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for chipsec.modules.tools.vmm.hv.define</h1><div class="highlight"><pre>
<span></span><span class="c1"># CHIPSEC: Platform Security Assessment Framework</span>
<span class="c1"># Copyright (c) 2010-2016, Intel Corporation</span>
<span class="c1">#</span>
<span class="c1"># This program is free software; you can redistribute it and/or</span>
<span class="c1"># modify it under the terms of the GNU General Public License</span>
<span class="c1"># as published by the Free Software Foundation; Version 2.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with this program; if not, write to the Free Software</span>
<span class="c1"># Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.</span>
<span class="c1">#</span>
<span class="c1"># Contact information:</span>
<span class="c1"># chipsec@intel.com</span>
<span class="c1">#</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Hyper-V specific defines</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="n">msrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mh">0x40000000</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_GUEST_OS_ID&#39;</span><span class="p">,</span>
    <span class="mh">0x40000001</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_HYPERCALL&#39;</span><span class="p">,</span>
    <span class="mh">0x40000002</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_VP_INDEX&#39;</span><span class="p">,</span>
    <span class="mh">0x40000003</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_RESET&#39;</span><span class="p">,</span>
    <span class="mh">0x40000010</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_VP_RUNTIME&#39;</span><span class="p">,</span>
    <span class="mh">0x40000020</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_TIME_REF_COUNT&#39;</span><span class="p">,</span>
    <span class="mh">0x40000021</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_REFERENCE_TSC&#39;</span><span class="p">,</span>
    <span class="mh">0x40000022</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_TSC_FREQUENCY&#39;</span><span class="p">,</span>
    <span class="mh">0x40000023</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_APIC_FREQUENCY&#39;</span><span class="p">,</span>
    <span class="mh">0x40000070</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_EOI&#39;</span><span class="p">,</span>
    <span class="mh">0x40000071</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_ICR&#39;</span><span class="p">,</span>
    <span class="mh">0x40000072</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_TPR&#39;</span><span class="p">,</span>
    <span class="mh">0x40000073</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_APIC_ASSIST_PAGE&#39;</span><span class="p">,</span>
    <span class="mh">0x40000080</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SCONTROL&#39;</span><span class="p">,</span>
    <span class="mh">0x40000081</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SVERSION&#39;</span><span class="p">,</span>
    <span class="mh">0x40000082</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SIEFP&#39;</span><span class="p">,</span>
    <span class="mh">0x40000083</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SIMP&#39;</span><span class="p">,</span>
    <span class="mh">0x40000084</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_EOM&#39;</span><span class="p">,</span>
    <span class="mh">0x40000090</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT0&#39;</span><span class="p">,</span>
    <span class="mh">0x40000091</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT1&#39;</span><span class="p">,</span>
    <span class="mh">0x40000092</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT2&#39;</span><span class="p">,</span>
    <span class="mh">0x40000093</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT3&#39;</span><span class="p">,</span>
    <span class="mh">0x40000094</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT4&#39;</span><span class="p">,</span>
    <span class="mh">0x40000095</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT5&#39;</span><span class="p">,</span>
    <span class="mh">0x40000096</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT6&#39;</span><span class="p">,</span>
    <span class="mh">0x40000097</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT7&#39;</span><span class="p">,</span>
    <span class="mh">0x40000098</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT8&#39;</span><span class="p">,</span>
    <span class="mh">0x40000099</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT9&#39;</span><span class="p">,</span>
    <span class="mh">0x4000009A</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT10&#39;</span><span class="p">,</span>
    <span class="mh">0x4000009B</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT11&#39;</span><span class="p">,</span>
    <span class="mh">0x4000009C</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT12&#39;</span><span class="p">,</span>
    <span class="mh">0x4000009D</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT13&#39;</span><span class="p">,</span>
    <span class="mh">0x4000009E</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT14&#39;</span><span class="p">,</span>
    <span class="mh">0x4000009F</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SINT15&#39;</span><span class="p">,</span>
    <span class="mh">0x400000B0</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_STIMER0_CONFIG&#39;</span><span class="p">,</span>
    <span class="mh">0x400000B1</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_STIMER0_COUNT&#39;</span><span class="p">,</span>
    <span class="mh">0x400000B2</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_STIMER1_CONFIG&#39;</span><span class="p">,</span>
    <span class="mh">0x400000B3</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_STIMER1_COUNT&#39;</span><span class="p">,</span>
    <span class="mh">0x400000B4</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_STIMER2_CONFIG&#39;</span><span class="p">,</span>
    <span class="mh">0x400000B5</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_STIMER2_COUNT&#39;</span><span class="p">,</span>
    <span class="mh">0x400000B6</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_STIMER3_CONFIG&#39;</span><span class="p">,</span>
    <span class="mh">0x400000B7</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_STIMER3_COUNT&#39;</span><span class="p">,</span>
    <span class="mh">0x400000C1</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_POWER_STATE_TRIGGER_C1&#39;</span><span class="p">,</span>
    <span class="mh">0x400000C2</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_POWER_STATE_TRIGGER_C2&#39;</span><span class="p">,</span>
    <span class="mh">0x400000C3</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_POWER_STATE_TRIGGER_C3&#39;</span><span class="p">,</span>
    <span class="mh">0x400000D1</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_POWER_STATE_CONFIG_C1&#39;</span><span class="p">,</span>
    <span class="mh">0x400000D2</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_POWER_STATE_CONFIG_C2&#39;</span><span class="p">,</span>
    <span class="mh">0x400000D3</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_POWER_STATE_CONFIG_C3&#39;</span><span class="p">,</span>
    <span class="mh">0x400000E0</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_STATS_PARTITION_RETAIL_PAGE&#39;</span><span class="p">,</span>
    <span class="mh">0x400000E1</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_STATS_PARTITION_INTERNAL_PAGE&#39;</span><span class="p">,</span>
    <span class="mh">0x400000E2</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_STATS_VP_RETAIL_PAGE&#39;</span><span class="p">,</span>
    <span class="mh">0x400000E3</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_STATS_VP_INTERNAL_PAGE&#39;</span><span class="p">,</span>
    <span class="mh">0x400000F0</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_GUEST_IDLE&#39;</span><span class="p">,</span>
    <span class="mh">0x400000F1</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SYNTH_DEBUG_CONTROL&#39;</span><span class="p">,</span>
    <span class="mh">0x400000F2</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SYNTH_DEBUG_STATUS&#39;</span><span class="p">,</span>
    <span class="mh">0x400000F3</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SYNTH_DEBUG_SEND_BUFFER&#39;</span><span class="p">,</span>
    <span class="mh">0x400000F4</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SYNTH_DEBUG_RECEIVE_BUFFER&#39;</span><span class="p">,</span>
    <span class="mh">0x400000F5</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_SYNTH_DEBUG_PENDING_BUFFER&#39;</span><span class="p">,</span>
    <span class="mh">0x40000100</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_CRASH_P0&#39;</span><span class="p">,</span>
    <span class="mh">0x40000101</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_CRASH_P1&#39;</span><span class="p">,</span>
    <span class="mh">0x40000102</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_CRASH_P2&#39;</span><span class="p">,</span>
    <span class="mh">0x40000103</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_CRASH_P3&#39;</span><span class="p">,</span>
    <span class="mh">0x40000104</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_CRASH_P4&#39;</span><span class="p">,</span>
    <span class="mh">0x40000105</span><span class="p">:</span> <span class="s1">&#39;HV_X64_MSR_CRASH_CTL&#39;</span>
<span class="p">}</span>


<div class="viewcode-block" id="get_msr_name">
<a class="viewcode-back" href="../../../../../../modules/chipsec.modules.tools.vmm.hv.define.html#chipsec.modules.tools.vmm.hv.define.get_msr_name">[docs]</a>
<span class="k">def</span> <span class="nf">get_msr_name</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">defvalue</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">msrs</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="k">if</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">msrs</span> <span class="k">else</span> <span class="n">defvalue</span></div>



<span class="n">hypercall_status_codes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mh">0x0000</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_SUCCESS&#39;</span><span class="p">,</span>
    <span class="mh">0x0001</span><span class="p">:</span> <span class="s1">&#39;HV_RESERVED_01H&#39;</span><span class="p">,</span>
    <span class="mh">0x0002</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_HYPERCALL_CODE&#39;</span><span class="p">,</span>
    <span class="mh">0x0003</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_HYPERCALL_INPUT&#39;</span><span class="p">,</span>
    <span class="mh">0x0004</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_ALIGNMENT&#39;</span><span class="p">,</span>
    <span class="mh">0x0005</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_PARAMETER&#39;</span><span class="p">,</span>
    <span class="mh">0x0006</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_ACCESS_DENIED&#39;</span><span class="p">,</span>
    <span class="mh">0x0007</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_PARTITION_STATE&#39;</span><span class="p">,</span>
    <span class="mh">0x0008</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_OPERATION_DENIED&#39;</span><span class="p">,</span>
    <span class="mh">0x0009</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_UNKNOWN_PROPERTY&#39;</span><span class="p">,</span>
    <span class="mh">0x000A</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROPERTY_VALUE_OUT_OF_RANGE&#39;</span><span class="p">,</span>
    <span class="mh">0x000B</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INSUFFICIENT_MEMORY&#39;</span><span class="p">,</span>
    <span class="mh">0x000C</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PARTITION_TOO_DEEP&#39;</span><span class="p">,</span>
    <span class="mh">0x000D</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_PARTITION_ID&#39;</span><span class="p">,</span>
    <span class="mh">0x000E</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_VP_INDEX&#39;</span><span class="p">,</span>
    <span class="mh">0x000F</span><span class="p">:</span> <span class="s1">&#39;HV_RESERVED_0FH&#39;</span><span class="p">,</span>
    <span class="mh">0x0010</span><span class="p">:</span> <span class="s1">&#39;HV_RESERVED_10H&#39;</span><span class="p">,</span>
    <span class="mh">0x0011</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_PORT_ID&#39;</span><span class="p">,</span>
    <span class="mh">0x0012</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_CONNECTION_ID&#39;</span><span class="p">,</span>
    <span class="mh">0x0013</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INSUFFICIENT_BUFFERS&#39;</span><span class="p">,</span>
    <span class="mh">0x0014</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_NOT_ACKNOWLEDGED&#39;</span><span class="p">,</span>
    <span class="mh">0x0015</span><span class="p">:</span> <span class="s1">&#39;HV_RESERVED_15H&#39;</span><span class="p">,</span>
    <span class="mh">0x0016</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_ACKNOWLEDGED&#39;</span><span class="p">,</span>
    <span class="mh">0x0017</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_SAVE_RESTORE_STATE&#39;</span><span class="p">,</span>
    <span class="mh">0x0018</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_SYNIC_STATE&#39;</span><span class="p">,</span>
    <span class="mh">0x0019</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_OBJECT_IN_USE&#39;</span><span class="p">,</span>
    <span class="mh">0x001A</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_PROXIMITY_DOMAIN_INFO&#39;</span><span class="p">,</span>
    <span class="mh">0x001B</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_NO_DATA&#39;</span><span class="p">,</span>
    <span class="mh">0x001C</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INACTIVE&#39;</span><span class="p">,</span>
    <span class="mh">0x001D</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_NO_RESOURCES&#39;</span><span class="p">,</span>
    <span class="mh">0x001E</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_FEATURE_UNAVAILABLE&#39;</span><span class="p">,</span>
    <span class="mh">0x001F</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PARTIAL_PACKET&#39;</span><span class="p">,</span>
    <span class="mh">0x0020</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_SSE3_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0021</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_LAHFSAHF_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0022</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_SSSE3_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0023</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_SSE4_1_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0024</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_SSE4_2_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0025</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_SSE4A_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0026</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_XOP_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0027</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_POPCNT_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0028</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_CMPXCHG16B_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0029</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_ALTMOVCR8_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x002A</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_LZCNT_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x002B</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_MISALIGNED_SSE_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x002C</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_MMX_EXT_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x002D</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_3DNOW_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x002E</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_EXTENDED_3DNOW_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x002F</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_PAGE_1GB_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0030</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_CACHE_LINE_FLUSH_SIZE_INCOMPATIBLE&#39;</span><span class="p">,</span>
    <span class="mh">0x0031</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_XSAVE_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0032</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_XSAVEOPT_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0033</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INSUFFICIENT_BUFFER&#39;</span><span class="p">,</span>
    <span class="mh">0x0034</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_XSAVE_AVX_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0035</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_XSAVE_FEATURE_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0036</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_XSAVE_SAVE_AREA_INCOMPATIBLE&#39;</span><span class="p">,</span>
    <span class="mh">0x0037</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INCOMPATIBLE_PROCESSOR&#39;</span><span class="p">,</span>
    <span class="mh">0x0038</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INSUFFICIENT_DEVICE_DOMAINS&#39;</span><span class="p">,</span>
    <span class="mh">0x0039</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_AES_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x003A</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_PCLMULQDQ_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x003B</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_INCOMPATIBLE_XSAVE_FEATURES&#39;</span><span class="p">,</span>
    <span class="mh">0x003C</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_CPUID_FEATURE_VALIDATION_ERROR&#39;</span><span class="p">,</span>
    <span class="mh">0x003D</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_CPUID_XSAVE_FEATURE_VALIDATION_ERROR&#39;</span><span class="p">,</span>
    <span class="mh">0x003E</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_STARTUP_TIMEOUT&#39;</span><span class="p">,</span>
    <span class="mh">0x003F</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_SMX_ENABLED&#39;</span><span class="p">,</span>
    <span class="mh">0x0040</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_PCID_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0041</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_INVALID_LP_INDEX&#39;</span><span class="p">,</span>
    <span class="mh">0x0042</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_FEATURE_FMA4_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0043</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_FEATURE_F16C_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0044</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_RDRAND_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0045</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_RDWRFSGS_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0046</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_SMEP_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0047</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_ENHANCED_FAST_STRING_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0048</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_MOVBE_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x0049</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_BMI1_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x004A</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_BMI2_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x004B</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_HLE_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x004C</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_RTM_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x004D</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_XSAVE_FMA_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x004E</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_XSAVE_AVX2_NOT_SUPPORTED&#39;</span><span class="p">,</span>
    <span class="mh">0x004F</span><span class="p">:</span> <span class="s1">&#39;HV_STATUS_PROCESSOR_FEATURE_NPIEP1_NOT_SUPPORTED&#39;</span>
<span class="p">}</span>


<div class="viewcode-block" id="get_hypercall_status">
<a class="viewcode-back" href="../../../../../../modules/chipsec.modules.tools.vmm.hv.define.html#chipsec.modules.tools.vmm.hv.define.get_hypercall_status">[docs]</a>
<span class="k">def</span> <span class="nf">get_hypercall_status</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">defvalue</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">hypercall_status_codes</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="k">if</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">hypercall_status_codes</span> <span class="k">else</span> <span class="n">defvalue</span></div>



<span class="n">hypercall_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mh">0x0001</span><span class="p">:</span> <span class="s1">&#39;HvSwitchVirtualAddressSpace&#39;</span><span class="p">,</span>
    <span class="mh">0x0002</span><span class="p">:</span> <span class="s1">&#39;HvFlushVirtualAddressSpace&#39;</span><span class="p">,</span>
    <span class="mh">0x0003</span><span class="p">:</span> <span class="s1">&#39;HvFlushVirtualAddressList&#39;</span><span class="p">,</span>
    <span class="mh">0x0004</span><span class="p">:</span> <span class="s1">&#39;HvGetLogicalProcessorRunTime&#39;</span><span class="p">,</span>
    <span class="mh">0x0008</span><span class="p">:</span> <span class="s1">&#39;HvNotifyLongSpinWait&#39;</span><span class="p">,</span>
    <span class="mh">0x0009</span><span class="p">:</span> <span class="s1">&#39;HvParkedVirtualProcessors&#39;</span><span class="p">,</span>
    <span class="mh">0x0040</span><span class="p">:</span> <span class="s1">&#39;HvCreatePartition&#39;</span><span class="p">,</span>
    <span class="mh">0x0041</span><span class="p">:</span> <span class="s1">&#39;HvInitializePartition&#39;</span><span class="p">,</span>
    <span class="mh">0x0042</span><span class="p">:</span> <span class="s1">&#39;HvFinalizePartition&#39;</span><span class="p">,</span>
    <span class="mh">0x0043</span><span class="p">:</span> <span class="s1">&#39;HvDeletePartition&#39;</span><span class="p">,</span>
    <span class="mh">0x0044</span><span class="p">:</span> <span class="s1">&#39;HvGetPartitionProperty&#39;</span><span class="p">,</span>
    <span class="mh">0x0045</span><span class="p">:</span> <span class="s1">&#39;HvSetPartitionProperty&#39;</span><span class="p">,</span>
    <span class="mh">0x0046</span><span class="p">:</span> <span class="s1">&#39;HvGetPartitionId&#39;</span><span class="p">,</span>
    <span class="mh">0x0047</span><span class="p">:</span> <span class="s1">&#39;HvGetNextChildPartition&#39;</span><span class="p">,</span>
    <span class="mh">0x0048</span><span class="p">:</span> <span class="s1">&#39;HvDepositMemory&#39;</span><span class="p">,</span>
    <span class="mh">0x0049</span><span class="p">:</span> <span class="s1">&#39;HvWithdrawMemory&#39;</span><span class="p">,</span>
    <span class="mh">0x004A</span><span class="p">:</span> <span class="s1">&#39;HvGetMemoryBalance&#39;</span><span class="p">,</span>
    <span class="mh">0x004B</span><span class="p">:</span> <span class="s1">&#39;HvMapGpaPages&#39;</span><span class="p">,</span>
    <span class="mh">0x004C</span><span class="p">:</span> <span class="s1">&#39;HvUnmapGpaPages&#39;</span><span class="p">,</span>
    <span class="mh">0x004D</span><span class="p">:</span> <span class="s1">&#39;HvInstallIntercept&#39;</span><span class="p">,</span>
    <span class="mh">0x004E</span><span class="p">:</span> <span class="s1">&#39;HvCreateVp&#39;</span><span class="p">,</span>
    <span class="mh">0x004F</span><span class="p">:</span> <span class="s1">&#39;HvDeleteVp&#39;</span><span class="p">,</span>
    <span class="mh">0x0050</span><span class="p">:</span> <span class="s1">&#39;HvGetVpRegisters&#39;</span><span class="p">,</span>
    <span class="mh">0x0051</span><span class="p">:</span> <span class="s1">&#39;HvSetVpRegisters&#39;</span><span class="p">,</span>
    <span class="mh">0x0052</span><span class="p">:</span> <span class="s1">&#39;HvTranslateVirtualAddress&#39;</span><span class="p">,</span>
    <span class="mh">0x0053</span><span class="p">:</span> <span class="s1">&#39;HvReadGpa&#39;</span><span class="p">,</span>
    <span class="mh">0x0054</span><span class="p">:</span> <span class="s1">&#39;HvWriteGpa&#39;</span><span class="p">,</span>
    <span class="mh">0x0055</span><span class="p">:</span> <span class="s1">&#39;HvAssertVirtualInterrupt&#39;</span><span class="p">,</span>
    <span class="mh">0x0056</span><span class="p">:</span> <span class="s1">&#39;HvClearVirtualInterrupt&#39;</span><span class="p">,</span>
    <span class="mh">0x0057</span><span class="p">:</span> <span class="s1">&#39;HvCreatePort&#39;</span><span class="p">,</span>
    <span class="mh">0x0058</span><span class="p">:</span> <span class="s1">&#39;HvDeletePort&#39;</span><span class="p">,</span>
    <span class="mh">0x0059</span><span class="p">:</span> <span class="s1">&#39;HvConnectPort&#39;</span><span class="p">,</span>
    <span class="mh">0x005A</span><span class="p">:</span> <span class="s1">&#39;HvGetPortProperty&#39;</span><span class="p">,</span>
    <span class="mh">0x005B</span><span class="p">:</span> <span class="s1">&#39;HvDisconnectPort&#39;</span><span class="p">,</span>
    <span class="mh">0x005C</span><span class="p">:</span> <span class="s1">&#39;HvPostMessage&#39;</span><span class="p">,</span>
    <span class="mh">0x005D</span><span class="p">:</span> <span class="s1">&#39;HvSignalEvent&#39;</span><span class="p">,</span>
    <span class="mh">0x005E</span><span class="p">:</span> <span class="s1">&#39;HvSavePartitionState&#39;</span><span class="p">,</span>
    <span class="mh">0x005F</span><span class="p">:</span> <span class="s1">&#39;HvRestorePartitionState&#39;</span><span class="p">,</span>
    <span class="mh">0x0060</span><span class="p">:</span> <span class="s1">&#39;HvInitializeEventLogBufferGroup&#39;</span><span class="p">,</span>
    <span class="mh">0x0061</span><span class="p">:</span> <span class="s1">&#39;HvFinalizeEventLogBufferGroup&#39;</span><span class="p">,</span>
    <span class="mh">0x0062</span><span class="p">:</span> <span class="s1">&#39;HvCreateEventLogBuffer&#39;</span><span class="p">,</span>
    <span class="mh">0x0063</span><span class="p">:</span> <span class="s1">&#39;HvDeleteEventLogBuffer&#39;</span><span class="p">,</span>
    <span class="mh">0x0064</span><span class="p">:</span> <span class="s1">&#39;HvMapEventLogBuffer&#39;</span><span class="p">,</span>
    <span class="mh">0x0065</span><span class="p">:</span> <span class="s1">&#39;HvUnmapEventLogBuffer&#39;</span><span class="p">,</span>
    <span class="mh">0x0066</span><span class="p">:</span> <span class="s1">&#39;HvSetEventLogGroupSources&#39;</span><span class="p">,</span>
    <span class="mh">0x0067</span><span class="p">:</span> <span class="s1">&#39;HvReleaseEventLogBuffer&#39;</span><span class="p">,</span>
    <span class="mh">0x0068</span><span class="p">:</span> <span class="s1">&#39;HvFlushEventLogBuffer&#39;</span><span class="p">,</span>
    <span class="mh">0x0069</span><span class="p">:</span> <span class="s1">&#39;HvPostDebugData&#39;</span><span class="p">,</span>
    <span class="mh">0x006A</span><span class="p">:</span> <span class="s1">&#39;HvRetrieveDebugData&#39;</span><span class="p">,</span>
    <span class="mh">0x006B</span><span class="p">:</span> <span class="s1">&#39;HvResetDebugSession&#39;</span><span class="p">,</span>
    <span class="mh">0x006C</span><span class="p">:</span> <span class="s1">&#39;HvMapStatsPage&#39;</span><span class="p">,</span>
    <span class="mh">0x006D</span><span class="p">:</span> <span class="s1">&#39;HvUnmapStatsPage&#39;</span><span class="p">,</span>
    <span class="mh">0x006E</span><span class="p">:</span> <span class="s1">&#39;HvCallMapSparseGpaPages&#39;</span><span class="p">,</span>
    <span class="mh">0x006F</span><span class="p">:</span> <span class="s1">&#39;HvCallSetSystemProperty&#39;</span><span class="p">,</span>
    <span class="mh">0x0070</span><span class="p">:</span> <span class="s1">&#39;HvCallSetPortProperty&#39;</span><span class="p">,</span>
    <span class="mh">0x0076</span><span class="p">:</span> <span class="s1">&#39;HvCallAddLogicalProcessor&#39;</span><span class="p">,</span>
    <span class="mh">0x0077</span><span class="p">:</span> <span class="s1">&#39;HvCallRemoveLogicalProcessor&#39;</span><span class="p">,</span>
    <span class="mh">0x0078</span><span class="p">:</span> <span class="s1">&#39;HvCallQueryNumaDistance&#39;</span><span class="p">,</span>
    <span class="mh">0x0079</span><span class="p">:</span> <span class="s1">&#39;HvCallSetLogicalProcessorProperty&#39;</span><span class="p">,</span>
    <span class="mh">0x007A</span><span class="p">:</span> <span class="s1">&#39;HvCallGetLogicalProcessorProperty&#39;</span><span class="p">,</span>
    <span class="mh">0x007B</span><span class="p">:</span> <span class="s1">&#39;HvCallGetSystemProperty&#39;</span><span class="p">,</span>
    <span class="mh">0x007C</span><span class="p">:</span> <span class="s1">&#39;HvCallMapDeviceInterrupt&#39;</span><span class="p">,</span>
    <span class="mh">0x007D</span><span class="p">:</span> <span class="s1">&#39;HvCallUnmapDeviceInterrupt&#39;</span><span class="p">,</span>
    <span class="mh">0x007E</span><span class="p">:</span> <span class="s1">&#39;HvCallCreateDeviceDomain&#39;</span><span class="p">,</span>
    <span class="mh">0x007F</span><span class="p">:</span> <span class="s1">&#39;HvCallDeleteDeviceDomain&#39;</span><span class="p">,</span>
    <span class="mh">0x0080</span><span class="p">:</span> <span class="s1">&#39;HvCallMapDevicePages&#39;</span><span class="p">,</span>
    <span class="mh">0x0081</span><span class="p">:</span> <span class="s1">&#39;HvCallUnmapDevicePages&#39;</span><span class="p">,</span>
    <span class="mh">0x0082</span><span class="p">:</span> <span class="s1">&#39;HvCallAttachDevice&#39;</span><span class="p">,</span>
    <span class="mh">0x0083</span><span class="p">:</span> <span class="s1">&#39;HvCallDetachDevice&#39;</span><span class="p">,</span>
    <span class="mh">0x0084</span><span class="p">:</span> <span class="s1">&#39;HvCallEnterSleepState&#39;</span><span class="p">,</span>
    <span class="mh">0x0085</span><span class="p">:</span> <span class="s1">&#39;HvCallPrepareForSleep&#39;</span><span class="p">,</span>
    <span class="mh">0x0086</span><span class="p">:</span> <span class="s1">&#39;HvCallPrepareForHibernate&#39;</span><span class="p">,</span>
    <span class="mh">0x0087</span><span class="p">:</span> <span class="s1">&#39;HvCallNotifyPartitionEvent&#39;</span><span class="p">,</span>
    <span class="mh">0x0088</span><span class="p">:</span> <span class="s1">&#39;HvCallGetLogicalProcessorRegisters&#39;</span><span class="p">,</span>
    <span class="mh">0x0089</span><span class="p">:</span> <span class="s1">&#39;HvCallSetLogicalProcessorRegisters&#39;</span><span class="p">,</span>
    <span class="mh">0x008A</span><span class="p">:</span> <span class="s1">&#39;HvCallQueryAssociatedLpsforMca&#39;</span><span class="p">,</span>
    <span class="mh">0x008B</span><span class="p">:</span> <span class="s1">&#39;HvCallNotifyRingEmpty&#39;</span><span class="p">,</span>
    <span class="mh">0x008C</span><span class="p">:</span> <span class="s1">&#39;HvCallInjectSyntheticMachineCheck&#39;</span><span class="p">,</span>
    <span class="mh">0x008D</span><span class="p">:</span> <span class="s1">&#39;HvCallScrubPartition&#39;</span><span class="p">,</span>
    <span class="mh">0x008E</span><span class="p">:</span> <span class="s1">&#39;HvCallCollectLivedump&#39;</span><span class="p">,</span>
    <span class="mh">0x008F</span><span class="p">:</span> <span class="s1">&#39;HvCallDisableHypervisor&#39;</span><span class="p">,</span>
    <span class="mh">0x0090</span><span class="p">:</span> <span class="s1">&#39;HvCallModifySparseGpaPages&#39;</span><span class="p">,</span>
    <span class="mh">0x0091</span><span class="p">:</span> <span class="s1">&#39;HvCallRegisterInterceptResult&#39;</span><span class="p">,</span>
    <span class="mh">0x0092</span><span class="p">:</span> <span class="s1">&#39;HvCallUnregisterInterceptResult&#39;</span>
<span class="p">}</span>


<div class="viewcode-block" id="get_hypercall_name">
<a class="viewcode-back" href="../../../../../../modules/chipsec.modules.tools.vmm.hv.define.html#chipsec.modules.tools.vmm.hv.define.get_hypercall_name">[docs]</a>
<span class="k">def</span> <span class="nf">get_hypercall_name</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">defvalue</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">hypercall_names</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="k">if</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">hypercall_names</span> <span class="k">else</span> <span class="n">defvalue</span></div>



<span class="n">hv_porttype</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mh">0x0001</span><span class="p">:</span> <span class="s1">&#39;HvPortTypeMessage&#39;</span><span class="p">,</span>
    <span class="mh">0x0002</span><span class="p">:</span> <span class="s1">&#39;HvPortTypeEvent&#39;</span><span class="p">,</span>
    <span class="mh">0x0003</span><span class="p">:</span> <span class="s1">&#39;HvPortTypeMonitor&#39;</span>
<span class="p">}</span>

<span class="n">GOOD_PARAMS_STATUSES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HV_STATUS_SUCCESS&#39;</span><span class="p">,</span> <span class="s1">&#39;HV_STATUS_ACCESS_DENIED&#39;</span><span class="p">]</span>

<span class="n">cpuid_desc</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x40000003</span><span class="p">:</span> <span class="p">{}}</span>

<span class="n">cpuid_desc</span><span class="p">[</span><span class="mh">0x40000003</span><span class="p">][</span><span class="s1">&#39;EAX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;VP Runtime (HV_X64_MSR_VP_RUNTIME) available&#39;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Partition Reference Counter (HV_X64_MSR_TIME_REF_COUNT) available&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Basic SynIC MSRs (HV_X64_MSR_SCONTROL..HV_X64_MSR_EOM and HV_X64_MSR_SINTxx) available&#39;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Synthetic Timer MSRs (HV_X64_MSR_STIMER0_CONFIG..HV_X64_MSR_STIMER3_COUNT) available&#39;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;APIC access MSRs (HV_X64_MSR_EOI, HV_X64_MSR_ICR and HV_X64_MSR_TPR) are available&#39;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;Hypercall MSRs (HV_X64_MSR_GUEST_OS_ID and HV_X64_MSR_HYPERCALL) available&#39;</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;Access virtual processor index MSR (HV_X64_MSR_VP_INDEX) available&#39;</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;Virtual system reset MSR (HV_X64_MSR_RESET) is available&#39;</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;Access statistics pages MSRs available&#39;</span><span class="p">,</span>
    <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;Partition Reference TSC MSR (HV_X64_MSR_REFERENCE_TSC) available&#39;</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;Virtual Guest Idle State MSR (HV_X64_MSR_GUEST_IDLE) available&#39;</span><span class="p">,</span>
    <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;Timer frequency MSRs (HV_X64_MSR_TSC_FREQUENCY and HV_X64_MSR_APIC_FREQUENCY) available&#39;</span><span class="p">,</span>
    <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;Debug MSRs (HV_X64_MSR_SYNTH_DEBUG_*) available&#39;</span>
<span class="p">}</span>

<span class="n">cpuid_desc</span><span class="p">[</span><span class="mh">0x40000003</span><span class="p">][</span><span class="s1">&#39;EBX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;CreatePartitions&#39;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;AccessPartitionId&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;AccessMemoryPool&#39;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;AdjustMessageBuffers&#39;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;PostMessages&#39;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;SignalEvents&#39;</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;CreatePort&#39;</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;ConnectPort&#39;</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;AccessStats&#39;</span><span class="p">,</span>
    <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;RsvdZ&#39;</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;RsvdZ&#39;</span><span class="p">,</span>
    <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;Debugging&#39;</span><span class="p">,</span>
    <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;CpuManagement&#39;</span><span class="p">,</span>
    <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;ConfigureProfiler&#39;</span><span class="p">,</span>
    <span class="mi">14</span><span class="p">:</span> <span class="s1">&#39;EnableExpandedStackwalking&#39;</span>
<span class="p">}</span>

<span class="n">cpuid_desc</span><span class="p">[</span><span class="mh">0x40000003</span><span class="p">][</span><span class="s1">&#39;ECX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Maximum Processor Power State (bit 0)&#39;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Maximum Processor Power State (bit 1)&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Maximum Processor Power State (bit 2)&#39;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;HPET is required to enter C3&#39;</span>
<span class="p">}</span>

<span class="n">cpuid_desc</span><span class="p">[</span><span class="mh">0x40000003</span><span class="p">][</span><span class="s1">&#39;EDX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;The MWAIT instruction is available&#39;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Guest debugging support is available&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Performance Monitor support is available&#39;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Support for physical CPU dynamic partitioning events is available&#39;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;Support for passing hypercall input parameter block via XMM registers is available&#39;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;Support for a virtual guest idle state is available&#39;</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;Support for hypervisor sleep state is available&#39;</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;Support for querying NUMA distances is available&#39;</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;Support for determining timer frequencies is available&#39;</span><span class="p">,</span>
    <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;Support for injecting synthetic machine checks is available&#39;</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;Support for guest crash MSRs is available&#39;</span><span class="p">,</span>
    <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;Support for debug MSRs is available&#39;</span><span class="p">,</span>
    <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;Npiep1Available&#39;</span><span class="p">,</span>
    <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;DiableHypervisorAvailable&#39;</span>
<span class="p">}</span>

<span class="c1">### HYPERV DEFINES #############################################################</span>

<span class="c1"># VMBUS version is 32 bit entity broken up into two 16 bit quantities: major_number . minor_number</span>
<span class="n">VERSION_WS2008</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">13</span><span class="p">))</span>  <span class="c1"># 0 . 13 (Windows Server 2008)</span>
<span class="n">VERSION_WIN7</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span><span class="p">))</span>   <span class="c1"># 1 . 1  (Windows 7)</span>
<span class="n">VERSION_WIN8</span> <span class="o">=</span> <span class="p">((</span><span class="mi">2</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">4</span><span class="p">))</span>   <span class="c1"># 2 . 4  (Windows 8)</span>
<span class="n">VERSION_WIN8_1</span> <span class="o">=</span> <span class="p">((</span><span class="mi">3</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">0</span><span class="p">))</span>   <span class="c1"># 3 . 0  (Windows 8 R2)</span>

<span class="n">vmbus_versions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">VERSION_WS2008</span><span class="p">:</span> <span class="s1">&#39;Windows Server 2008&#39;</span><span class="p">,</span>
    <span class="n">VERSION_WIN7</span><span class="p">:</span> <span class="s1">&#39;Windows 7&#39;</span><span class="p">,</span>
    <span class="n">VERSION_WIN8</span><span class="p">:</span> <span class="s1">&#39;Windows 8&#39;</span><span class="p">,</span>
    <span class="n">VERSION_WIN8_1</span><span class="p">:</span> <span class="s1">&#39;Windows 8 R2&#39;</span>
<span class="p">}</span>

<span class="n">VMBUS_MESSAGE_CONNECTION_ID</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">VMBUS_MESSAGE_PORT_ID</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">VMBUS_EVENT_CONNECTION_ID</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">VMBUS_EVENT_PORT_ID</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">VMBUS_MONITOR_CONNECTION_ID</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">VMBUS_MONITOR_PORT_ID</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">VMBUS_MESSAGE_SINT</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1">### HV MESSAGE DEFINES #########################################################</span>

<span class="c1"># Define hypervisor message types</span>
<span class="n">hv_message_type</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mh">0x00000000</span><span class="p">:</span> <span class="s1">&#39;HVMSG_NONE&#39;</span><span class="p">,</span>
    <span class="c1"># Memory access messages</span>
    <span class="mh">0x80000000</span><span class="p">:</span> <span class="s1">&#39;HVMSG_UNMAPPED_GPA&#39;</span><span class="p">,</span>
    <span class="mh">0x80000001</span><span class="p">:</span> <span class="s1">&#39;HVMSG_GPA_INTERCEPT&#39;</span><span class="p">,</span>
    <span class="c1"># Timer notification messages</span>
    <span class="mh">0x80000010</span><span class="p">:</span> <span class="s1">&#39;HVMSG_TIMER_EXPIRED&#39;</span><span class="p">,</span>
    <span class="c1"># Error messages</span>
    <span class="mh">0x80000020</span><span class="p">:</span> <span class="s1">&#39;HVMSG_INVALID_VP_REGISTER_VALUE&#39;</span><span class="p">,</span>
    <span class="mh">0x80000021</span><span class="p">:</span> <span class="s1">&#39;HVMSG_UNRECOVERABLE_EXCEPTION&#39;</span><span class="p">,</span>
    <span class="mh">0x80000022</span><span class="p">:</span> <span class="s1">&#39;HVMSG_UNSUPPORTED_FEATURE&#39;</span><span class="p">,</span>
    <span class="c1"># Trace buffer complete messages</span>
    <span class="mh">0x80000040</span><span class="p">:</span> <span class="s1">&#39;HVMSG_EVENTLOG_BUFFERCOMPLETE&#39;</span><span class="p">,</span>
    <span class="c1"># Platform-specific processor intercept messages</span>
    <span class="mh">0x80010000</span><span class="p">:</span> <span class="s1">&#39;HVMSG_X64_IOPORT_INTERCEPT&#39;</span><span class="p">,</span>
    <span class="mh">0x80010001</span><span class="p">:</span> <span class="s1">&#39;HVMSG_X64_MSR_INTERCEPT&#39;</span><span class="p">,</span>
    <span class="mh">0x80010002</span><span class="p">:</span> <span class="s1">&#39;HVMSG_X64_CPUID_INTERCEPT&#39;</span><span class="p">,</span>
    <span class="mh">0x80010003</span><span class="p">:</span> <span class="s1">&#39;HVMSG_X64_EXCEPTION_INTERCEPT&#39;</span><span class="p">,</span>
    <span class="mh">0x80010004</span><span class="p">:</span> <span class="s1">&#39;HVMSG_X64_APIC_EOI&#39;</span><span class="p">,</span>
    <span class="mh">0x80010005</span><span class="p">:</span> <span class="s1">&#39;HVMSG_X64_LEGACY_FP_ERROR&#39;</span>
<span class="p">}</span>

<span class="c1">### MSG CHANNEL DEFINES ########################################################</span>

<span class="n">CHANNELMSG_INVALID</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">CHANNELMSG_OFFERCHANNEL</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">CHANNELMSG_RESCIND_CHANNELOFFER</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">CHANNELMSG_REQUESTOFFERS</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">CHANNELMSG_ALLOFFERS_DELIVERED</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">CHANNELMSG_OPENCHANNEL</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">CHANNELMSG_OPENCHANNEL_RESULT</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">CHANNELMSG_CLOSECHANNEL</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">CHANNELMSG_GPADL_HEADER</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">CHANNELMSG_GPADL_BODY</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">CHANNELMSG_GPADL_CREATED</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">CHANNELMSG_GPADL_TEARDOWN</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">CHANNELMSG_GPADL_TORNDOWN</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">CHANNELMSG_RELID_RELEASED</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">CHANNELMSG_INITIATE_CONTACT</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">CHANNELMSG_VERSION_RESPONSE</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">CHANNELMSG_UNLOAD</span> <span class="o">=</span> <span class="mi">16</span>

<span class="n">vmbus_channel_message_type</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageInvalid&#39;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageOfferChannel&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageRescindChannelOffer&#39;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageRequestOffers&#39;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageAllOffersDelivered&#39;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageOpenChannel&#39;</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageOpenChannelResult&#39;</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageCloseChannel&#39;</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageGpadlHeader&#39;</span><span class="p">,</span>
    <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageGpadlBody&#39;</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageGpadlCreated&#39;</span><span class="p">,</span>
    <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageGpadlTeardown&#39;</span><span class="p">,</span>
    <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageGpadlTorndown&#39;</span><span class="p">,</span>
    <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageRelIdReleased&#39;</span><span class="p">,</span>
    <span class="mi">14</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageInitiateContact&#39;</span><span class="p">,</span>
    <span class="mi">15</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageVersionResponse&#39;</span><span class="p">,</span>
    <span class="mi">16</span><span class="p">:</span> <span class="s1">&#39;ChannelMessageUnload&#39;</span>
<span class="p">}</span>

<span class="n">channel_flags</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mh">0x00</span><span class="p">:</span> <span class="s1">&#39;VMBUS_CHANNEL_ENUMERATE_DEVICE_INTERFACE&#39;</span><span class="p">,</span>
    <span class="mh">0x01</span><span class="p">:</span> <span class="s1">&#39;VMBUS_CHANNEL_SERVER_SUPPORTS_TRANSFER_PAGES&#39;</span><span class="p">,</span>
    <span class="mh">0x02</span><span class="p">:</span> <span class="s1">&#39;VMBUS_CHANNEL_SERVER_SUPPORTS_GPADLS&#39;</span><span class="p">,</span>
    <span class="mh">0x04</span><span class="p">:</span> <span class="s1">&#39;VMBUS_CHANNEL_NAMED_PIPE_MODE&#39;</span><span class="p">,</span>
    <span class="mh">0x08</span><span class="p">:</span> <span class="s1">&#39;VMBUS_CHANNEL_LOOPBACK_OFFER&#39;</span><span class="p">,</span>
    <span class="mh">0x09</span><span class="p">:</span> <span class="s1">&#39;VMBUS_CHANNEL_PARENT_OFFER&#39;</span><span class="p">,</span>
    <span class="mh">0x0a</span><span class="p">:</span> <span class="s1">&#39;VMBUS_CHANNEL_REQUEST_MONITORED_NOTIFICATION&#39;</span>
<span class="p">}</span>

<span class="c1"># GUID definitions of various offer types - services offered to the guest</span>
<span class="n">HV_NIC_GUID</span> <span class="o">=</span> <span class="s1">&#39;{f8615163-df3e-46c5-913f-f2d2f965ed0e}&#39;</span>
<span class="n">HV_IDE_GUID</span> <span class="o">=</span> <span class="s1">&#39;{32412632-86cb-44a2-9b5c-50d1417354f5}&#39;</span>
<span class="n">HV_SCSI_GUID</span> <span class="o">=</span> <span class="s1">&#39;{ba6163d9-04a1-4d29-b605-72e2ffb1dc7f}&#39;</span>
<span class="n">HV_SHUTDOWN_GUID</span> <span class="o">=</span> <span class="s1">&#39;{0e0b6031-5213-4934-818b-38d90ced39db}&#39;</span>
<span class="n">HV_TS_GUID</span> <span class="o">=</span> <span class="s1">&#39;{9527e630-d0ae-497b-adce-e80ab0175caf}&#39;</span>
<span class="n">HV_HEART_BEAT_GUID</span> <span class="o">=</span> <span class="s1">&#39;{57164f39-9115-4e78-ab55-382f3bd5422d}&#39;</span>
<span class="n">HV_KVP_GUID</span> <span class="o">=</span> <span class="s1">&#39;{a9a0f4e7-5a45-4d96-b827-8a841e8c03e6}&#39;</span>
<span class="n">HV_DM_GUID</span> <span class="o">=</span> <span class="s1">&#39;{525074dc-8985-46e2-8057-a307dc18a502}&#39;</span>
<span class="n">HV_MOUSE_GUID</span> <span class="o">=</span> <span class="s1">&#39;{cfa8b69e-5b4a-4cc0-b98b-8ba1a1f3f95a}&#39;</span>
<span class="n">HV_VSS_GUID</span> <span class="o">=</span> <span class="s1">&#39;{35fa2e29-ea23-4236-ae96-3a6ebacba440}&#39;</span>
<span class="n">HV_SYNTHVID_GUID</span> <span class="o">=</span> <span class="s1">&#39;{da0a7802-e377-4aac-8e77-0558eb1073f8}&#39;</span>
<span class="n">HV_SYNTHFC_GUID</span> <span class="o">=</span> <span class="s1">&#39;{2f9bcc4a-0069-4af3-b76b-6fd0be528cda}&#39;</span>
<span class="n">HV_FCOPY_GUID</span> <span class="o">=</span> <span class="s1">&#39;{34d14be3-dee4-41c8-9ae7-6b174977c192}&#39;</span>
<span class="n">HV_KBD_GUID</span> <span class="o">=</span> <span class="s1">&#39;{f912ad6d-2b17-48ea-bd65-f927a61c7684}&#39;</span>
<span class="n">REMOTE_DESKTOP_GUID</span> <span class="o">=</span> <span class="s1">&#39;{276aacf4-ac15-426c-98dd-7521ad3f01fe}&#39;</span>
<span class="n">VOLUME_SHADOW_COPY_GUID</span> <span class="o">=</span> <span class="s1">&#39;{35fa2e29-ea23-4236-96ae-3a6ebacba440}&#39;</span>
<span class="n">AVMA_GUID</span> <span class="o">=</span> <span class="s1">&#39;{3375baf4-9e15-4b30-b765-67acb10d607b}&#39;</span>
<span class="n">DESKTOP_CONTROL_GUID</span> <span class="o">=</span> <span class="s1">&#39;{f8e65716-3cb3-4a06-9a60-1889c5cccab5}&#39;</span>

<span class="n">hv_guid_desc</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">HV_NIC_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Network&#39;</span><span class="p">,</span>
    <span class="n">HV_IDE_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V IDE&#39;</span><span class="p">,</span>
    <span class="n">HV_SCSI_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V SCSI Controller&#39;</span><span class="p">,</span>
    <span class="n">HV_SHUTDOWN_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Shutdown&#39;</span><span class="p">,</span>
    <span class="n">HV_TS_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Time Synch&#39;</span><span class="p">,</span>
    <span class="n">HV_HEART_BEAT_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Heartbeat&#39;</span><span class="p">,</span>
    <span class="n">HV_KVP_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V KVP&#39;</span><span class="p">,</span>
    <span class="n">HV_DM_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Dynamic memory&#39;</span><span class="p">,</span>
    <span class="n">HV_MOUSE_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Mouse&#39;</span><span class="p">,</span>
    <span class="n">HV_VSS_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V VSS Backup/Restore&#39;</span><span class="p">,</span>
    <span class="n">HV_SYNTHVID_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Synthetic Video&#39;</span><span class="p">,</span>
    <span class="n">HV_SYNTHFC_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Synthetic FC&#39;</span><span class="p">,</span>
    <span class="n">HV_FCOPY_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Guest File Copy Service&#39;</span><span class="p">,</span>
    <span class="n">HV_KBD_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Virtual Keyboard&#39;</span><span class="p">,</span>
    <span class="n">REMOTE_DESKTOP_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Remote Desktop Virtualization&#39;</span><span class="p">,</span>
    <span class="n">VOLUME_SHADOW_COPY_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Volume Shadow Copy&#39;</span><span class="p">,</span>
    <span class="n">AVMA_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Automatic Virtual Machine Activation (AVMA)&#39;</span><span class="p">,</span>
    <span class="n">DESKTOP_CONTROL_GUID</span><span class="p">:</span> <span class="s1">&#39;Microsoft Hyper-V Remote Desktop Control Channel&#39;</span>
<span class="p">}</span>

<span class="c1">### VMBUS PACKET DEFINES #######################################################</span>

<span class="n">vm_pkt</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mh">0x0</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_INVALID&#39;</span><span class="p">,</span>
    <span class="mh">0x1</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_SYNCH&#39;</span><span class="p">,</span>
    <span class="mh">0x2</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_ADD_XFER_PAGESET&#39;</span><span class="p">,</span>
    <span class="mh">0x3</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_RM_XFER_PAGESET&#39;</span><span class="p">,</span>
    <span class="mh">0x4</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_ESTABLISH_GPADL&#39;</span><span class="p">,</span>
    <span class="mh">0x5</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_TEARDOWN_GPADL&#39;</span><span class="p">,</span>
    <span class="mh">0x6</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_DATA_INBAND&#39;</span><span class="p">,</span>
    <span class="mh">0x7</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_DATA_USING_XFER_PAGES&#39;</span><span class="p">,</span>
    <span class="mh">0x8</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_DATA_USING_GPADL&#39;</span><span class="p">,</span>
    <span class="mh">0x9</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_DATA_USING_GPA_DIRECT&#39;</span><span class="p">,</span>
    <span class="mh">0xa</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_CANCEL_REQUEST&#39;</span><span class="p">,</span>
    <span class="mh">0xb</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_COMP&#39;</span><span class="p">,</span>
    <span class="mh">0xc</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_DATA_USING_ADDITIONAL_PKT&#39;</span><span class="p">,</span>
    <span class="mh">0xd</span><span class="p">:</span> <span class="s1">&#39;VM_PKT_ADDITIONAL_DATA&#39;</span>
<span class="p">}</span>

<span class="n">VMBUS_DATA_PACKET_FLAG_COMPLETION_REQUESTED</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1">################################################################################</span>


<div class="viewcode-block" id="set_variables">
<a class="viewcode-back" href="../../../../../../modules/chipsec.modules.tools.vmm.hv.define.html#chipsec.modules.tools.vmm.hv.define.set_variables">[docs]</a>
<span class="k">def</span> <span class="nf">set_variables</span><span class="p">(</span><span class="n">varlist</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">varlist</span><span class="p">:</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([a-z])([A-Z]+)&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\1_\2&quot;</span><span class="p">,</span> <span class="n">varlist</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">exec</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;global </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">; </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s1">d</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>



<span class="n">set_variables</span><span class="p">(</span><span class="n">msrs</span><span class="p">)</span>
<span class="n">set_variables</span><span class="p">(</span><span class="n">hypercall_status_codes</span><span class="p">)</span>
<span class="n">set_variables</span><span class="p">(</span><span class="n">hypercall_names</span><span class="p">)</span>
<span class="n">set_variables</span><span class="p">(</span><span class="n">hv_porttype</span><span class="p">)</span>
<span class="n">set_variables</span><span class="p">(</span><span class="n">hv_message_type</span><span class="p">)</span>
<span class="n">set_variables</span><span class="p">(</span><span class="n">channel_flags</span><span class="p">)</span>
<span class="n">set_variables</span><span class="p">(</span><span class="n">vm_pkt</span><span class="p">)</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../../../index.html">
              <img class="logo" src="../../../../../../_static/chipsec_logo_transparent.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../../../../index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">Start here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../start/Contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../start/Download.html">Download CHIPSEC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../installation/InstallLinux.html">Linux Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../installation/InstallWinDAL.html">DAL Windows Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../installation/InstallWindows.html">Windows Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../installation/USBwithUEFIShell.html">Building a Bootable USB drive with UEFI Shell (x64)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using CHIPSEC</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../usage/Interpreting-Results.html">Interpreting results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../usage/Running-Chipsec.html">Running CHIPSEC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Architecture and Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../development/Architecture-Overview.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../development/Configuration-Files.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../development/Developing.html">Writing Your Own Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../development/OS-Helpers-and-Drivers.html">OS Helpers and Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../development/Platform-Detection.html">Methods for Platform Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../development/Sample-Module-Code.html">Sample module code template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../development/Vulnerabilities-and-CHIPSEC-Modules.html">CHIPSEC Modules</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contribution Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../contribution/code-style-python.html">Python Version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../contribution/code-style-python.html#python-coding-style-guide">Python Coding Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../contribution/code-style-python.html#f-strings">f-Strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../contribution/code-style-python.html#type-hints">Type Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../contribution/code-style-python.html#underscores-in-numeric-literals">Underscores in Numeric Literals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../contribution/code-style-python.html#walrus-operator">Walrus Operator (:=)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../contribution/code-style-python.html#deprecate-distutils-module-support">Deprecate distutils module support</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../../index.html">CHIPSEC  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">chipsec.modules.tools.vmm.hv.define</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Last updated on Dec 18, 2023.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>